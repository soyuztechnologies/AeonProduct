var oGuid;sap.ui.define(["oft/fiori/controller/BaseController","sap/m/MessageBox","sap/m/MessageToast","oft/fiori/models/formatter"],function(e,t,a,i){"use strict";return e.extend("oft.fiori.controller.batch",{formatter:i,expandStartDate:function(e){var t=new Array;t[0]="JAN";t[1]="FEB";t[2]="MAR";t[3]="APR";t[4]="MAY";t[5]="JUN";t[6]="JUL";t[7]="AUG";t[8]="SEP";t[9]="OCT";t[10]="NOV";t[11]="DEC";var a=e.split(".");var i=a[1]+"/"+a[0]+"/"+a[2];var s=new Date(i);var r=t[s.getMonth()];var o=s.getFullYear();return r+"_"+o},onInit:function(){this.oRouter=sap.ui.core.UIComponent.getRouterFor(this);this.oRouter.attachRoutePatternMatched(this.herculis,this);var e=this.getModel("local").getProperty("/CurrentUser");var t=this.getModel("local").oData.AppUsers[e].UserName;t="Hey "+t;this.getView().byId("idUser").setText(t)},onBack:function(){sap.ui.getCore().byId("idApp").to("idView1")},onDeleteBatch:function(e){var a=this;t.confirm("Do you want to delete the selected batch?",function(e){if(e=="OK"){debugger;var t="/Courses('"+oGuid+"')";a.ODataHelper.callOData(a.getOwnerComponent().getModel(),t,"DELETE",{},{},a).then(function(e){sap.m.MessageToast.show("Batch Deleted succesfully");a.onClearScreen()}).catch(function(e){a.getView().setBusy(false);a.oPopover=a.getErrorMessage(e);a.getView().setBusy(false)})}},"Confirmation")},onSave:function(e){console.log(this.getView().getModel("local").getProperty("/newBatch"));var t=e;var a=this;var i=this.getView().getModel("local").getProperty("/newBatch");debugger;var s={BatchNo:i.batchName,CourseId:i.courseId,TrainerId:i.trainerId,DemoStartDate:this.getView().byId("idDemoDate").getDateValue(),StartDate:this.getView().byId("idStartDate").getDateValue(),EndDate:this.getView().byId("idEndDate").getDateValue(),Weekend:i.weekend,hidden:String(i.hidden),StartTime:i.startTime,EndTime:i.endTime,Fee:i.courseFee,CreatedOn:new Date,status:i.status};if(this.flag==="batchid"){this.ODataHelper.callOData(this.getOwnerComponent().getModel(),"/Courses('"+oGuid+"')","PUT",{},s,this).then(function(e){a.getView().setBusy(false);sap.m.MessageToast.show("Course Updated successfully");a.destroyMessagePopover()}).catch(function(e){a.getView().setBusy(false);var t=a.getErrorMessage(e)})}else{this.ODataHelper.callOData(this.getOwnerComponent().getModel(),"/Courses","POST",{},s,this).then(function(e){a.getView().setBusy(false);sap.m.MessageToast.show("New Course Saved successfully");a.destroyMessagePopover()}).catch(function(e){a.getView().setBusy(false);var t=a.getErrorMessage(e)})}},onStartChange:function(e){var t=e.getSource().getValue();var a=t.split(".");var i=new Date(a[2],a[1]-1,a[0]);var s=this.formatter.getIncrementDate(i,2.5);this.getView().getModel("local").setProperty("/newBatch/endDate",s);console.log(s);this.updateBatchName()},onTimeChange:function(e){},herculis:function(e){if(e.getParameter("name")!=="batch"){return}this.getView().getModel("local").setProperty("/newBatch/startDate",this.formatter.getFormattedDate(0));this.getView().getModel("local").setProperty("/newBatch/demoStartDate",this.formatter.getFormattedDate(0));this.getView().getModel("local").setProperty("/newBatch/endDate",this.formatter.getFormattedDate(2.5));this.getView().getModel("local").setProperty("/newBatch/blogDate",this.formatter.getFormattedDate(8))},onChange:function(){debugger;alert("HELLOOO")},onSelect:function(e){this.flag="courseName";this.getCustomerPopup();var t=this.getView().getModel("i18n").getProperty("course");this.searchPopup.setTitle(t);this.searchPopup.bindAggregation("items",{path:"/CoursesMst",template:new sap.m.DisplayListItem({label:"{CourseName}",value:"{Category}"})})},onTrainerSelect:function(e){this.flag="trainerName";this.getCustomerPopup();var t="Trainer Name";this.searchPopup.setTitle(t);this.searchPopup.bindAggregation("items",{path:"/Trainers",template:new sap.m.DisplayListItem({label:"{FirstName} {LastName}",value:"{city}"})})},updateBatchName:function(){var e=this.getModel("local").getProperty("/newBatch");debugger;var t=this.expandStartDate(e.startDate);e.batchName=e.courseName+"_"+t+"_"+e.trainerName;e.batchName=e.batchName.split(" ").join("")},onConfirm:function(e){if(this.flag==="courseName"){var t=e.getParameter("selectedItem").getLabel();this.getView().getModel("local").setProperty("/newBatch/courseName",t);var a=e.getParameter("selectedItem").getBindingContextPath().split("'")[1];this.getView().getModel("local").setProperty("/newBatch/courseId",a);this.updateBatchName()}if(this.flag==="trainerName"){var i=e.getParameter("selectedItem").getLabel();this.getView().getModel("local").setProperty("/newBatch/trainerName",i);var s=e.getParameter("selectedItem").getBindingContextPath().split("'")[1];this.getView().getModel("local").setProperty("/newBatch/trainerId",s);this.updateBatchName()}if(this.flag==="batchid"){debugger;var r=this.getSelectedKey(e);this.getView().byId("idCourseId").setValue(r[1]);this.getView().byId("idCourseId").setEnabled(false);var o="Courses('"+r[2]+"')";var l=this.getView().getModel().oData[o];var n=this;var d=this.getView().getModel().oData;if(l){var a=l.CourseId;var g="CoursesMst('"+a+"')";var t=d[g].CourseName;var h=this.getView().byId("batch");h.setValue(t);h.setEnabled(false);debugger;var s=l.TrainerId;var u="Trainers('"+s+"')";var c=this.getView().byId("idTrainer");if(d[u]){var i=d[u].FirstName+" "+d[u].LastName;c.setValue(i)}c.setEnabled(false);var m=this.onDateFormatted(l.DemoStartDate);var p=this.getView().byId("idDemoDate");p.setValue(m);var w=this.onDateFormatted(l.StartDate);var f=this.getView().byId("idStartDate");f.setValue(w);f.setEnabled(false);var v=this.onDateFormatted(l.EndDate);var V=this.getView().byId("idEndDate");V.setValue(v);var b=l.Fee;var y=this.getView().byId("idFee");y.setValue(b);var D=l.StartTime;var I=this.getView().byId("idStartTime");I.setValue(D);D=l.EndTime;var I=this.getView().byId("idEndTime");I.setValue(D);oGuid=l.id;var P=l.Weekend;if(P===true){var C=this.getView().byId("idWeekend").setSelected(true)}else{var C=this.getView().byId("idWeekend").setSelected(false)}var B=l.hidden;var S;if(B===true){S=this.getView().byId("idChkBtcHid").setSelected(true)}else{S=this.getView().byId("idChkBtcHid").setSelected(false)}var M=l.status;var N=this.getView().byId("idStatus");N.setSelectedKey(M)}}},onClearScreen:function(){this.getView().byId("idCourseId").setValue("");this.getView().byId("idCourseId").setEnabled(true);this.getView().byId("batch").setValue("");this.getView().byId("batch").setEnabled(true);this.getView().byId("idTrainer").setValue("");this.getView().byId("idTrainer").setEnabled(true);this.getView().byId("idStartTime").setValue("");this.getView().byId("idEndTime").setValue("");this.getView().byId("idDemoDate").setValue("");this.getView().byId("idStartDate").setValue("");this.getView().byId("idStartDate").setEnabled(true);this.getView().byId("idEndDate").setValue("");this.getView().byId("idFee").setValue("");this.getView().byId("idStatus").setValue("");this.getView().byId("idWeekend").setSelected("");this.getView().byId("idChkBtcHid").setSelected("")},onBatchSelect:function(){this.flag="batchid";this.getCustomerPopup();var e=this.getView().getModel("i18n").getProperty("batch");this.searchPopup.setTitle(e);this.searchPopup.bindAggregation("items",{path:"/Courses",template:new sap.m.DisplayListItem({label:"{BatchNo}",value:"{StartTime}"})})},onLiveSearch:function(e){var t=e.getParameter("query");if(!t){t=e.getParameter("value")}if(e.getSource().getTitle()===this.getView().getModel("i18n").getProperty("course")){if(t){var a=new sap.ui.model.Filter("courseName",sap.ui.model.FilterOperator.Contains,t);var i=new sap.ui.model.Filter({filters:[a],and:false});var s=[i];this.searchPopup.getBinding("items").filter(s)}else{this.searchPopup.bindAggregation("items",{path:"local>/courses",template:new sap.m.DisplayListItem({label:"{local>courseName}"})});this.searchPopup.getBinding("items").filter([])}}if(e.getSource().getTitle()===this.getView().getModel("i18n").getProperty("batch")){if(t){var a=new sap.ui.model.Filter("BatchNo",sap.ui.model.FilterOperator.Contains,t);var i=new sap.ui.model.Filter({filters:[a],and:false});var s=[i];this.searchPopup.getBinding("items").filter(s)}else{this.searchPopup.bindAggregation("items",{path:"local>/Courses",template:new sap.m.DisplayListItem({label:"{local>BatchNo}",value:"{local>StartTime}"})});this.searchPopup.getBinding("items").filter([])}}if(e.getSource().getTitle()==="Trainer Name"){if(t){var a=new sap.ui.model.Filter("FirstName",sap.ui.model.FilterOperator.Contains,t);var r=new sap.ui.model.Filter("LastName",sap.ui.model.FilterOperator.Contains,t);var i=new sap.ui.model.Filter({filters:[a,r],and:false});var s=[i];this.searchPopup.getBinding("items").filter(s)}else{this.searchPopup.bindAggregation("items",{path:"local>/Trainers",template:new sap.m.DisplayListItem({label:"{FirstName} {LastName}",value:"{city}"})});this.searchPopup.getBinding("items").filter([])}}}})});
//# sourceMappingURL=batch.controller.js.map